# A Convolutional Neural Network for predicting HIV Integration Sites
This repository contains python notebooks used for training a CNN to predict proviral HIV integration sites in the human genome. This repository is part of a degree project written by Senad Matuh Delic, the full-text PDF can be found [ at DiVa portal](http://www.diva-portal.org/smash/record.jsf?pid=diva2%3A1463584).
### Note
The notebooks use datasets generated by the [Retrovirus Integration Database Parser & Training Set Generator](https://github.com/senadmd/RetrovirusIntegrationDatabaseParser). The datasets have been generated from a raw HTML dump of the Retrovirus Integration Database *(performed 2019-10-07)*. The raw dump is available for download using below URL in case you want to reproduce all the data:
  `https://kth-project.s3.eu-north-1.amazonaws.com/database_dump_result.zip`
 *The raw dump is hosted with permisssion from Wei Shao (Retrovirus Integration Database), please cite Retrovirus Integration Database project if you intend to use this data in your project*



## Getting Started

This repository contains multiple python notebooks that use [Keras API](https://keras.io/) to create a convolutional neural network for predicting HIV integration sites. The main notebook is [HIV_Provirus_CNN.ipynb](HIV_Provirus_CNN.ipynb) while the other notebooks are attempts at improving the performance of the main neural network design.  

The python notebooks can be executed on a machine having Tensorflow installed, or in Google Colaboratory [![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/senadmd/HIVProvirusIntegrationPrediction/blob/master/HIV_Provirus_CNN.ipynb) with GPU runtime.

### Prerequisites

To run this project you need [Tensorflow 1.15.0](https://www.tensorflow.org/) with [Matplotlib](https://matplotlib.org/) and [Biopython 1.76](https://biopython.org/).

## Performance and comparison
In attempt at improving the performance of CNN developed in the notebook [HIV_Provirus_CNN.ipynb](HIV_Provirus_CNN.ipynb), we have modified the neural network design with the addition L2 regularization and layers performing batch normalization. By adding batch normalization, one will see that the neural network performs better on the training set, but this improvement is not reflected on the validation data as shown below. The addition of L2 regularization did not improve the performance of model at all. 

| Notebook | Validation Loss | Validation Accuracy |
| --- | --- | --- |
| [HIV_Provirus_CNN.ipynb](HIV_Provirus_CNN.ipynb)  | 0.4643 | 0.7786|
| [HIV_Provirus_CNN_BatchNormalizationAndL2.ipynb](HIV_Provirus_CNN_BatchNormalizationAndL2.ipynb) | 0.6289 | 0.7069 |
| [HIV_Provirus_CNN_L2Regularization.ipynb](HIV_Provirus_CNN_L2Regularization.ipynb) | 0.6266 | 0.6880 |
| [HIV_Provirus_CNN_BatchNormalization.ipynb](HIV_Provirus_CNN_BatchNormalization.ipynb) | 0.7883 | 0.6467 |
| [HIV_Provirus_CNN_SGD.ipynb](HIV_Provirus_CNN_SGD.ipynb)  | 0.6324 | 0.6442|


## Authors

* **Senad Matuh Delic** 



## Acknowledgments

* I thank the authors of Retrovirus Integration Database for aligning HIV insert positions from multiple studies against a single genome assembly.
*Wei Shao, Jigui Shan, Mary Kearney, Xiaolin Wu, Frank Maldarelli, John W. Mellors, Brian Luke, John M. Coffin, and Stephen H. Hughes. [Retrovirus Integration Database (RID): a public database for retroviral insertion sites into host genomes. Retrovirology 2016 13:47](http://www.retrovirology.com/content/13/1/47)*
* The UCSC genome browser team for making the genome assemblies easily accessible: *UCSC Genome Browser: Kent WJ, Sugnet CW, Furey TS, Roskin KM, Pringle TH, Zahler AM, Haussler D. [The human genome browser at UCSC](http://www.genome.org/cgi/content/abstract/12/6/996). Genome Res. 2002 Jun;12(6):996-1006.*
* *Human genome assembly: The Genome Sequencing Consortium. [Initial sequencing and analysis of the human genome](http://www.nature.com/nature/journal/v409/n6822/abs/409860a0.html). Nature. 2001 Feb 15;409(6822):860-921.*